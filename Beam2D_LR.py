# internal force vector
t1 = 0.1e1 / l
t2 = u1 * t1
t3 = u2 * t1
t4 = t2 - t3
t6 = t1 * t4 + t1
t8 = t4 ** 2
t12 = w1 * t1 - w2 * t1
t13 = t12 ** 2
t15 = t8 / 2 + t13 / 2 + t2 - t3
t17 = phi1 + phi2
t18 = np.sin(t17 / 2)
t19 = t18 * t1
t21 = np.cos(t17 / 2)
t23 = t21 * t12 + t18 * t4 + t18
t24 = t23 * GAq
t25 = t24 * t19
t26 = t1 * t21
t29 = phi1 * t1 - phi2 * t1
t30 = t29 ** 2
t34 = -t12 * t18 + t4 * t21 + t21
t35 = t34 * EI * t30
t36 = t35 * t26
t44 = t15 * EA * t1 * t12 - t35 * t19 + t24 * t26
t47 = t23 * GAq * t34 / 2
t48 = -t29 * t23 / 2
t49 = t1 * t34
t52 = t29 * t34

fin = np.zeros((6,1))
fin[0] = (t15 * EA * t6 + t25 + t36) * l
fin[1] = t44 * l
fin[2] = (t47 + t52 * EI * (t48 + t49)) * l
fin[3] = (-t15 * EA * t6 - t25 - t36) * l
fin[4] = -t44 * l
fin[5] = (t47 + t52 * EI * (t48 - t49)) * l

# element stiffness matrix
t1 = 0.1e1 / l
t2 = t1 * (u1 - u2)
t3 = t1 * (w1 - w2)
t4 = t3 ** 2
t5 = 0.1e1 / 0.2e1
t6 = t5 * (t2 ** 2 + t4) + t2
t2 = t2 + 1
t7 = t1 * t2
t8 = t5 * (phi1 + phi2)
t9 = np.sin(t8)
t8 = np.cos(t8)
t10 = t1 * (phi1 - phi2)
t11 = t8 ** 2
t12 = t9 ** 2
t13 = t10 ** 2 * EI
t14 = t1 ** 2
t15 = (EA * t6 + GAq * t12 + t13 * t11) * t14
t16 = t1 * t9
t17 = t16 * t8 * (-t13 + GAq)
t18 = t7 * EA
t19 = t1 * (t18 * t3 + t17)
t20 = t9 * t2 + t3 * t8
t2 = t8 * t2 - t3 * t9
t21 = t9 * t2
t22 = t9 * t2
t23 = t8 * t20
t24 = t8 * t2
t25 = 2 * t24 * t14 * t10 * EI
t26 = t5 * t1 * (GAq * (t23 + t22) + t13 * (-t8 * t20 - t21))
t27 = t25 + t26
t25 = -t25 + t26
t26 = l * t19
t18 = l * (t18 * t7 + t15)
t19 = l * t19
t4 = t14 * ((t4 + t6) * EA + GAq * t11 + t13 * t12)
t6 = t9 * t20
t11 = t8 * t2
t12 = 2 * t21 * t14 * t10 * EI
t14 = t5 * t1 * (GAq * (-t11 + t6) + t13 * (-t9 * t20 + t24))
t21 = -t12 - t14
t3 = t1 * (EA * t3 * t7 + t17)
t12 = t12 - t14
t14 = l * t4
t17 = l * t3
t4 = l * t4
t9 = t5 * t9 * t10
t24 = t1 * t8
t28 = t1 * (-t9 + t24)
t29 = t5 * t20 * t10
t30 = t1 * t2
t31 = -t29 + t30
t32 = t31 * t1
t33 = t32 * t8
t34 = EI * t10
t35 = t1 * GAq
t22 = t5 * t35 * (t23 + t22)
t23 = t5 * t8 * t10
t36 = -t1 * (t23 + t16)
t37 = t16 * t31
t5 = t5 * t35 * (-t11 + t6)
t6 = -t2 * t10 / 4
t11 = t20 * t1
t35 = EI * t2
t20 = t20 ** 2
t38 = -GAq * (-t2 ** 2 + t20) / 4
t13 = -t2 * (-GAq * t2 + t13 * t2) / 4 - t20 * GAq / 4
t3 = l * t3
t9 = -t1 * (t9 + t24)
t20 = -t29 - t30
t24 = t20 * t1
t8 = t24 * t8
t1 = t1 * (-t23 + t16)
t16 = t16 * t20
t20 = t20 * EI
k = np.array([[l * (EA * t7 ** 2 + t15),t26,l * t27,-t18,-t19,l * t25],[t26,t14,l * t21,-t17,-t4,l * t12],[l * (t34 * (t2 * t28 + t33) + t22),l * (t34 * (t2 * t36 - t37) - t5),l * (t35 * (t10 * (-t11 + t6) + t32) + t38 - t29 * t31 * EI),l * (t34 * (-t2 * t28 - t33) - t22),l * (t34 * (-t2 * t36 + t37) + t5),l * (t13 - t31 * EI * (t29 + t30))],[-t18,-t17,-l * t27,l * (EA * t7 ** 2 + t15),t3,-l * t25],[-t19,-t4,-l * t21,t3,t14,-l * t12],[l * (t34 * (t9 * t2 + t8) + t22),l * (t34 * (t1 * t2 - t16) - t5),l * (t13 + t20 * (-t29 + t30)),l * (t34 * (-t9 * t2 - t8) - t22),l * (t34 * (-t1 * t2 + t16) + t5),l * (t35 * (t10 * (t6 + t11) - t24) + t38 - t20 * t29)]])


#geometrix stiffness matrix
t1 = 0.1e1 / l
t2 = t1 * (u1 - u2)
t3 = t1 * (w1 - w2)
t4 = 0.1e1 / 0.2e1
t5 = t4 * (phi1 + phi2)
t6 = np.cos(t5)
t5 = np.sin(t5)
t7 = t2 + 1
t8 = t3 * t6 + t5 * t7
t9 = t1 * (phi1 - phi2)
t7 = -t3 * t5 + t6 * t7
t10 = t9 ** 2
t11 = t6 * GAq * t8
t12 = t1 ** 2
t13 = t4 * t1 * (-t5 * t10 * EI * t7 + t11)
t14 = t6 * t12 * t9 * EI * t7
t15 = t14 + t13
t13 = -t14 + t13
t2 = t1 * EA * (t4 * (t2 ** 2 + t3 ** 2) + t2)
t3 = t5 * GAq * t8
t14 = t4 * t1 * (t6 * t10 * EI * t7 + t3)
t12 = t5 * t12 * t9 * EI * t7
t16 = -t14 - t12
t12 = -t14 + t12
t14 = t4 * t5 * t9
t17 = t1 * t6
t18 = t1 * (t17 - t14)
t11 = t11 * t4 * t1
t6 = t4 * t6 * t9
t5 = t1 * t5
t19 = -t1 * (t6 + t5)
t3 = t3 * t4 * t1
t4 = -t7 * t9 / 4
t20 = t8 * t1
t21 = -t8 ** 2 * GAq / 4
t8 = -l * (t7 ** 2 * t10 * EI + t8 ** 2 * GAq) / 4
t10 = -t1 * (t17 + t14)
t1 = t1 * (-t6 + t5)
kg = np.array([[t2,0,l * t15,-t2,0,l * t13],[0,t2,l * t16,0,-t2,l * t12],[l * (t18 * EI * t7 * t9 + t11),l * (t19 * EI * t7 * t9 - t3),l * (t21 + (t4 - t20) * EI * t7 * t9),l * (-t18 * EI * t7 * t9 - t11),l * (-t19 * EI * t7 * t9 + t3),t8],[-t2,0,-l * t15,t2,0,-l * t13],[0,-t2,-l * t16,0,t2,-l * t12],[l * (t7 * t10 * EI * t9 + t11),l * (t1 * EI * t7 * t9 - t3),t8,l * (-t7 * t10 * EI * t9 - t11),l * (-t1 * EI * t7 * t9 + t3),l * (t21 + (t4 + t20) * EI * t7 * t9)]])
